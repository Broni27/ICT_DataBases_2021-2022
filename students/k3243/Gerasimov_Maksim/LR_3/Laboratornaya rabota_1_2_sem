--
-- PostgreSQL database dump
--

-- Dumped from database version 13.6
-- Dumped by pg_dump version 13.6

-- Started on 2022-03-19 16:14:19

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

DROP DATABASE dblab31;
--
-- TOC entry 3058 (class 1262 OID 16395)
-- Name: dblab31; Type: DATABASE; Schema: -; Owner: postgres
--

CREATE DATABASE dblab31 WITH TEMPLATE = template0 ENCODING = 'UTF8' LOCALE = 'Russian_Russia.1251';


ALTER DATABASE dblab31 OWNER TO postgres;

\connect dblab31

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- TOC entry 203 (class 1259 OID 16405)
-- Name: address; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.address (
    id_address integer NOT NULL,
    room "char" NOT NULL,
    rack "char" NOT NULL,
    shelf "char" NOT NULL
);


ALTER TABLE public.address OWNER TO postgres;

--
-- TOC entry 202 (class 1259 OID 16403)
-- Name: address_id_address_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.address ALTER COLUMN id_address ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.address_id_address_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 205 (class 1259 OID 16419)
-- Name: book; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.book (
    id_book integer NOT NULL,
    translator character varying,
    issue_date date,
    issue_place character varying,
    language character varying,
    sphere_of_knowledge character varying,
    name character varying,
    author character varying,
    CONSTRAINT date CHECK ((issue_date <= '2022-03-19'::date))
);


ALTER TABLE public.book OWNER TO postgres;

--
-- TOC entry 204 (class 1259 OID 16417)
-- Name: book_id_book_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.book ALTER COLUMN id_book ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.book_id_book_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 207 (class 1259 OID 16431)
-- Name: giving; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.giving (
    id_giving integer NOT NULL,
    id_reader integer NOT NULL,
    id_instance integer NOT NULL,
    condition character varying,
    backgiving date NOT NULL,
    fact_backgiving date,
    id_worker integer NOT NULL
);


ALTER TABLE public.giving OWNER TO postgres;

--
-- TOC entry 206 (class 1259 OID 16429)
-- Name: giving_id_giving_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.giving ALTER COLUMN id_giving ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.giving_id_giving_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 201 (class 1259 OID 16398)
-- Name: instance; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.instance (
    id_instance integer NOT NULL,
    price integer NOT NULL,
    code character varying NOT NULL,
    data_exec date,
    id_address integer,
    id_book integer
);


ALTER TABLE public.instance OWNER TO postgres;

--
-- TOC entry 200 (class 1259 OID 16396)
-- Name: instance_id_instance_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.instance ALTER COLUMN id_instance ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.instance_id_instance_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 211 (class 1259 OID 16455)
-- Name: reader; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.reader (
    id_reader integer NOT NULL,
    surname character varying NOT NULL,
    name character varying NOT NULL,
    patr_name character varying,
    phone_number character varying NOT NULL,
    address character varying NOT NULL
);


ALTER TABLE public.reader OWNER TO postgres;

--
-- TOC entry 210 (class 1259 OID 16453)
-- Name: reader_id_reader_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.reader ALTER COLUMN id_reader ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.reader_id_reader_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 212 (class 1259 OID 16465)
-- Name: registration; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.registration (
    id_reader integer NOT NULL,
    id_worker integer NOT NULL,
    reg_date date NOT NULL,
    ex_date date,
    CONSTRAINT date CHECK ((reg_date < ex_date))
);


ALTER TABLE public.registration OWNER TO postgres;

--
-- TOC entry 209 (class 1259 OID 16443)
-- Name: worker; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.worker (
    id_worker integer NOT NULL,
    surname character varying NOT NULL,
    name character varying NOT NULL,
    patr_name character varying,
    code_access integer NOT NULL
);


ALTER TABLE public.worker OWNER TO postgres;

--
-- TOC entry 208 (class 1259 OID 16441)
-- Name: worker_id_worker_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.worker ALTER COLUMN id_worker ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.worker_id_worker_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 3043 (class 0 OID 16405)
-- Dependencies: 203
-- Data for Name: address; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.address (id_address, room, rack, shelf) VALUES (1, '2', '4', '5');
INSERT INTO public.address (id_address, room, rack, shelf) VALUES (2, '2', '4', '6');
INSERT INTO public.address (id_address, room, rack, shelf) VALUES (3, '2', '8', '5');
INSERT INTO public.address (id_address, room, rack, shelf) VALUES (4, '2', '4', '5');
INSERT INTO public.address (id_address, room, rack, shelf) VALUES (5, '1', '3', '5');
INSERT INTO public.address (id_address, room, rack, shelf) VALUES (6, '2', '4', '5');
INSERT INTO public.address (id_address, room, rack, shelf) VALUES (7, '2', '2', '5');
INSERT INTO public.address (id_address, room, rack, shelf) VALUES (8, '2', '4', '5');


--
-- TOC entry 3045 (class 0 OID 16419)
-- Dependencies: 205
-- Data for Name: book; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.book (id_book, translator, issue_date, issue_place, language, sphere_of_knowledge, name, author) VALUES (1, 'NULL', '1989-01-01', 'Москва', 'Русский', 'Художественное', 'Муму', 'Тургенев');
INSERT INTO public.book (id_book, translator, issue_date, issue_place, language, sphere_of_knowledge, name, author) VALUES (2, 'NULL', '1989-01-01', 'Москва', 'Русский', 'Публицистика', 'Земля зовёт', 'Третьяков');
INSERT INTO public.book (id_book, translator, issue_date, issue_place, language, sphere_of_knowledge, name, author) VALUES (3, 'NULL', '1971-01-01', 'Ленинград', 'Русский', 'Документальное', 'Научный коммунизм в Африке', 'Стогова');
INSERT INTO public.book (id_book, translator, issue_date, issue_place, language, sphere_of_knowledge, name, author) VALUES (4, 'NULL', '1989-01-01', 'Волхов', 'Русский', 'Публицистика', 'Мурманский каракуль', 'Александрова');
INSERT INTO public.book (id_book, translator, issue_date, issue_place, language, sphere_of_knowledge, name, author) VALUES (5, 'NULL', '1964-01-01', 'Тамбов', 'Английский', 'Документальное', 'Одноэтажная Америка', 'Ступников');
INSERT INTO public.book (id_book, translator, issue_date, issue_place, language, sphere_of_knowledge, name, author) VALUES (6, 'NULL', '1971-01-01', 'Минск', 'Английский', 'Документальное', 'Как украсть миллион рублей (белорусских)', 'Александр Григорьевич Л.');


--
-- TOC entry 3047 (class 0 OID 16431)
-- Dependencies: 207
-- Data for Name: giving; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.giving (id_giving, id_reader, id_instance, condition, backgiving, fact_backgiving, id_worker) VALUES (1, 1, 1, '3', '2022-02-28', NULL, 4);
INSERT INTO public.giving (id_giving, id_reader, id_instance, condition, backgiving, fact_backgiving, id_worker) VALUES (2, 2, 2, '3', '2022-02-21', NULL, 1);
INSERT INTO public.giving (id_giving, id_reader, id_instance, condition, backgiving, fact_backgiving, id_worker) VALUES (3, 3, 3, '3', '2022-02-25', NULL, 2);
INSERT INTO public.giving (id_giving, id_reader, id_instance, condition, backgiving, fact_backgiving, id_worker) VALUES (4, 4, 4, '3', '2022-02-22', NULL, 4);


--
-- TOC entry 3041 (class 0 OID 16398)
-- Dependencies: 201
-- Data for Name: instance; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.instance (id_instance, price, code, data_exec, id_address, id_book) VALUES (1, 120, '24', NULL, 1, 1);
INSERT INTO public.instance (id_instance, price, code, data_exec, id_address, id_book) VALUES (2, 1200, '24', NULL, 2, 4);
INSERT INTO public.instance (id_instance, price, code, data_exec, id_address, id_book) VALUES (3, 520, '24', NULL, 3, 5);
INSERT INTO public.instance (id_instance, price, code, data_exec, id_address, id_book) VALUES (4, 147, '24', NULL, 8, 6);
INSERT INTO public.instance (id_instance, price, code, data_exec, id_address, id_book) VALUES (5, 420, '24', NULL, 6, 1);


--
-- TOC entry 3051 (class 0 OID 16455)
-- Dependencies: 211
-- Data for Name: reader; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.reader (id_reader, surname, name, patr_name, phone_number, address) VALUES (1, 'Герасимов', 'Максим', 'Игоревич', '+79523661978', 'Frauenstrasse 46, 120');
INSERT INTO public.reader (id_reader, surname, name, patr_name, phone_number, address) VALUES (2, 'Дулькин', 'Илья', 'Денисович', '+79523661979', 'Detterstr. 21, 202');
INSERT INTO public.reader (id_reader, surname, name, patr_name, phone_number, address) VALUES (3, 'Исхакова', 'Эмина', 'Фидратовна', '+79523661991', 'Detterstr. 21, 007');
INSERT INTO public.reader (id_reader, surname, name, patr_name, phone_number, address) VALUES (4, 'Коробковский', 'Вадим', 'Андреевич', '+79523667878', 'Ул. Пограничника Гарькавого 16к2 кв.24');


--
-- TOC entry 3052 (class 0 OID 16465)
-- Dependencies: 212
-- Data for Name: registration; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.registration (id_reader, id_worker, reg_date, ex_date) VALUES (1, 4, '2015-01-01', NULL);
INSERT INTO public.registration (id_reader, id_worker, reg_date, ex_date) VALUES (2, 4, '2014-01-13', NULL);
INSERT INTO public.registration (id_reader, id_worker, reg_date, ex_date) VALUES (3, 1, '2015-03-03', NULL);
INSERT INTO public.registration (id_reader, id_worker, reg_date, ex_date) VALUES (4, 2, '2015-01-01', NULL);


--
-- TOC entry 3049 (class 0 OID 16443)
-- Dependencies: 209
-- Data for Name: worker; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.worker (id_worker, surname, name, patr_name, code_access) VALUES (1, 'Петропчук', 'Агафий', 'Афанасьевич', 1);
INSERT INTO public.worker (id_worker, surname, name, patr_name, code_access) VALUES (2, 'Свистоплясов', 'Виталий', 'Денисович', 2);
INSERT INTO public.worker (id_worker, surname, name, patr_name, code_access) VALUES (3, 'Муравьедов', 'Игорь', 'Олегович', 2);
INSERT INTO public.worker (id_worker, surname, name, patr_name, code_access) VALUES (4, 'Танченко', 'Юлия', 'Валерьевна', 3);


--
-- TOC entry 3059 (class 0 OID 0)
-- Dependencies: 202
-- Name: address_id_address_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.address_id_address_seq', 1, false);


--
-- TOC entry 3060 (class 0 OID 0)
-- Dependencies: 204
-- Name: book_id_book_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.book_id_book_seq', 1, false);


--
-- TOC entry 3061 (class 0 OID 0)
-- Dependencies: 206
-- Name: giving_id_giving_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.giving_id_giving_seq', 1, false);


--
-- TOC entry 3062 (class 0 OID 0)
-- Dependencies: 200
-- Name: instance_id_instance_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.instance_id_instance_seq', 1, false);


--
-- TOC entry 3063 (class 0 OID 0)
-- Dependencies: 210
-- Name: reader_id_reader_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.reader_id_reader_seq', 1, false);


--
-- TOC entry 3064 (class 0 OID 0)
-- Dependencies: 208
-- Name: worker_id_worker_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.worker_id_worker_seq', 1, false);


--
-- TOC entry 2894 (class 2606 OID 16409)
-- Name: address address_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.address
    ADD CONSTRAINT address_pkey PRIMARY KEY (id_address);


--
-- TOC entry 2898 (class 2606 OID 16435)
-- Name: giving giving_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.giving
    ADD CONSTRAINT giving_pkey PRIMARY KEY (id_giving);


--
-- TOC entry 2896 (class 2606 OID 16423)
-- Name: book id_book; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.book
    ADD CONSTRAINT id_book PRIMARY KEY (id_book);


--
-- TOC entry 2892 (class 2606 OID 16416)
-- Name: instance id_instance; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.instance
    ADD CONSTRAINT id_instance PRIMARY KEY (id_instance) INCLUDE (id_instance);


--
-- TOC entry 2902 (class 2606 OID 16459)
-- Name: reader id_reader; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.reader
    ADD CONSTRAINT id_reader PRIMARY KEY (id_reader);


--
-- TOC entry 2900 (class 2606 OID 16447)
-- Name: worker id_worker; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.worker
    ADD CONSTRAINT id_worker PRIMARY KEY (id_worker) INCLUDE (id_worker);


--
-- TOC entry 2903 (class 2606 OID 16410)
-- Name: instance id_address; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.instance
    ADD CONSTRAINT id_address FOREIGN KEY (id_address) REFERENCES public.address(id_address) NOT VALID;


--
-- TOC entry 2904 (class 2606 OID 16424)
-- Name: instance id_book; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.instance
    ADD CONSTRAINT id_book FOREIGN KEY (id_book) REFERENCES public.book(id_book) NOT VALID;


--
-- TOC entry 2905 (class 2606 OID 16436)
-- Name: giving id_instance; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.giving
    ADD CONSTRAINT id_instance FOREIGN KEY (id_instance) REFERENCES public.instance(id_instance) NOT VALID;


--
-- TOC entry 2907 (class 2606 OID 16460)
-- Name: giving id_reader; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.giving
    ADD CONSTRAINT id_reader FOREIGN KEY (id_reader) REFERENCES public.reader(id_reader) NOT VALID;


--
-- TOC entry 2908 (class 2606 OID 16470)
-- Name: registration id_reader; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.registration
    ADD CONSTRAINT id_reader FOREIGN KEY (id_reader) REFERENCES public.reader(id_reader);


--
-- TOC entry 2906 (class 2606 OID 16448)
-- Name: giving id_worker; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.giving
    ADD CONSTRAINT id_worker FOREIGN KEY (id_worker) REFERENCES public.worker(id_worker) NOT VALID;


--
-- TOC entry 2909 (class 2606 OID 16475)
-- Name: registration id_worker; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.registration
    ADD CONSTRAINT id_worker FOREIGN KEY (id_worker) REFERENCES public.worker(id_worker) NOT VALID;


-- Completed on 2022-03-19 16:14:19

--
-- PostgreSQL database dump complete
--

